Notes sur JTB
<<<<<<< HEAD
- jtbgram.jtb a √©t√© √©crite √† partir de JavaCC.jj de la version JavaCC 4.2, et adapt√©e (voir commentaires ModMMa) :
  * renommages de noms de classes et de productions
  * ajout de la syntaxe try-ExpansionChoices-catch-finally (ExpansionUnitInTCF) 
  * ajout des syntaxes ! et % pour ne pas g√©n√©rer des n≈ìuds JTB
  * corrections sur la grammaire java
  * ajout des options par d√©faut
- Token.java a √©t√© modifi√©e pour l'ajout de GTToken (possibilit√© pr√©vue dans Token, impliquant une sauvegarde et une copie)
- parser.JavaFiles, parser.OtherFilesGen, parser.ParseGen & utils.JavaFileGenerator ont √©t√© modifi√©es pour GTToken
   (commentaires : // ModMMa : modified for Token.template with GTToken),
   mais en fait cela ne sert √† rien parce c'est JavaCC et non JTB qui g√©n√®re Token.java (via parser.OtherFilesGen.java), 
   et bien que le ficher /templates/Token.template n'existe pas cela ne se voit pas car les 4 classes ne sont pas utilis√©es
- dans les specials : on a les commentaires de fin de ligne report√©s √† la ligne suivante, et les premiers sauts de ligne bouff√©s
   il faudrait que JavaCC passe au sch√©ma trailing / orphan / leading comme dans JavaParser,
   ou bien il faudrait g√©rer dans NodeToken le delta des lignes avec le token pr√©c√©dent
   
Notes sur JavaCC
- les essais String.intern() dans ParseursForms sur SimpleCharStream.GetImage(), en construisant une TreeMap des litt√©raux d√©clar√©s dans la grammaire (r√©cup√©r√©s de xxxConstants) (les litt√©raux sont automatiquement intern√©s par le compilateur et sont en tr√®s grand nombre dans les statistiques ; cf. https://shipilev.net/jvm/anatomy-quarks/10-string-intern/ -XX:+PrintStringTableStatistics -XX:StringTableSize) ne sont pas concluants (il faut profiler SANS l'enregistrement des allocations sinon les temps sont trop distordus) : le temps pass√© dans GetImage contrebalance le temps gagn√© sur les allocations ; il faudrait regarder, dans le TokenManager, jjFillToken() et jjstrLiteralImages qui ne contient que les litt√©raux "uniques" (si un Regexpr est un OR de litt√©raux, style < EOL : "\r\n" | "\r" | "\n" >, le litt√©ral est retrouv√© dans GetImage et n'est pas intern√© ; s'il c'est un seul litt√©ral, style < AT : "@" >, il est r√©cup√©r√© du tableau jjstrLiteralImages et est donc automatiquement intern√©) ; il faudrait voir √† √©tendre ce m√©canisme

G√©n√©ration avec des templates de fichiers
- ajouter des options pour indiquer les fichiers √† g√©n√©rer
- DepthFirst Visitors : 
  * √† fixer par JTB :
    $ noms des classes et interfaces de base : fait
  * √† laisser au choix de l'utilisateur :
    $ visitorDir JTB_VD/JTB_VP fait & classesList (DFVG)
    $ noms des classes et interfaces des visiteurs, n, n., argu, depthLevel, jtbrt_ (default dans Globals)
    $ options prefix/suffix/package/directory/superclass/jb.out.jj (changeable dans Globals)
    $ comment : permettre de surcharger Globals ou autre ?
- voir pour les commentaires initiaux (generated by, date, nom du template, version de JTB, ...)
 
Id√©es futuristes sur JTB/JavaCC
- revoir les concepts et voir o√π la programmation fonctionnelle et une meilleure approche objet peuvent simplifier les choses
- voir √† ajouter dans la grammaire la gestion des versions d'une grammaire
- voir √† ajouter la fonctionnalit√© de recouvrement de tokens (ex : mot r√©serv√© qui peut √™tre un identifieur) (pour ne pas √™tre oblig√©s de rajouter des OR)
- revoir la g√©n√©ration JavaCC pour les m√©thodes spagettis et l'influence des changements d'√©tats lexicaux sur les performances
- revoir la g√©n√©ration JavaCC pour les switchs g√©n√©r√©s (tableaux √† double indirection pour lookups performants, ...)
- revoir la g√©n√©ration des infos de debug (lookahead)
- revoir la structure de la grammaire pour maximiser le r√©emploi des grammaires : 1 source grammaire (voire 2 sources lexer/parser), n sources options g√©n√©ration (noeuds √† g√©n√©rer ou non, visiteurs, Unicode, mono-multi thread, avec/sans debug, ...)
- voir de quoi on peut s'inspirer de XText (g√©n√©ration pour plugin, ...), JavaCC 21 (simplification dans la g√©n√©ration JavaCC, AST / parsers int√©gr√©s, ...), TreeSitter (?)
- voir √† produire un table driven tokenmanager (comme javacc 8) et/ou g√©n√©ration avec templates FreeMarker/Velocity (avec le syst√®me 1.5.0 ou comme javacc 8 / 21)
- g√©n√©rer en une seule passe JTB+JavaCC
- produire des versions Kotlin, C, C++, JavaScript... (grammaires sources et parseurs cibles)
- voir √† faire un int√©gr√© JTB/JavaCC (comme JavaCC 21) (une seule grammaire, g√©n√©ration ASTs style JTB ou JJTree et parsing en une seule fois)
- √©crire une grammaire en pur java via des annotations (pour ne plus avoir √† mettre √† jour des plugins IDE)
- voir √† faire un parser incr√©mental / fault tolerant
- voir √† faire un LSP

A faire prochainement sur JTB
- voir pourquoi signature/* ne sont pas marqu√©s d√©riv√©s
- tcf avec autres options
- tests exhaustifs sur suppression / ajout de noeuds
- changer le NodeToken pour qu'il r√©f√©rence le Token au lieu de copier ses propri√©t√©s (v√©rifier que les Tokens sont GCed bien avant les NodeTokens), ou mieux (?) faire h√©riter Token d'un NodeToken 
- supprimer les intern() dans makeNodeToken
- corriger le bug rencontr√© sur la 1.5.0 sur BindVariable du parser PL/SQL (mauvaise g√©n√©ration du jj annotation finale n11 = ... au lieu de n2 = ...)
- g√©n√©rer correctement les commentaires lorsque l'on utilise un noeud JAVACODE (%)
- ajouter la gestion du cha√Ænage des parseurs, passer JTB en un parseur pur JTB et un parseur Java, mettre √† jour la grammaire Java 13+
- corriger le type de retour lorsqu'il est qualifi√© par son package BNF et JavaCode productions a.b.Cd Cd() ...
- corriger le NPE sur syntaxe [ "x" ! ] ou [ Prod() ! ] ou [ Prod() ] sur une Prod() !
- changer la syntaxe ! par #void, % par #xyz, ajouter #xyz pour permettre la surcharge du noeud 
- ajouter une option pour le cha√Ænage des NodeTokens comme pour les Tokens de JavaCC
- revoir la gestion des specials en visitant tous les identifieurs et en imprimant les specials √† ce moment l√†
- voir √† accepter les noms de production qui posent conflit, ex String
- voir le NPE dans les visiteurs lorsque le n≈ìud n'est pas cr√©√©
- construire des exemples de grammaire avec des Lookahead dans Expansion et dans ExpansionUnit, et avec (<TK> | {})
- voir pourquoi les classes ne sont pas g√©n√©r√©es pour les productions orphelines
- voir les options par d√©faut jtb (options/wiki) et plugin ia/jd/tk true ou false ?
- mettre √† jour le wiki (overview, // 1.5.0, et ajouter une doc plus compl√®te, en particulier diff√©rences // JJT)
- mettre √† jour le plugin maven
- choisir un repository maven pour publier jtb et son plugin maven
- √©crire une doc pour target ant via une task java
- mettre des tests JUnit dans le build ?
- voir si corrections bugs JavaCC dont char e = '√©';
- voir les ajouts faits par FA ou √† faire pour JavaCC 6+ et C++
- ajouter dans les tests que JTB fonctionne avec et sans les commentaires de debug
- ajouter dans les tests que JTB/JavaCC peut tourner en multi thread
- voir √† ajouter des benchmarks jmh
- voir √† am√©liorer les indicateurs de qualit√©
- voir les aspects s√©curit√©

Fait sur JTB en 1.5.1
- corrig√© des probl√®mes de g√©n√©ration de node (node choice, EUNS)
- chang√© le package de jtbgram.jtb pour l'aligner avec la d√©claration interne
- corrig√© la g√©n√©ration des imports pour diff√©rentes combinaisons d'options
- am√©lior√© la g√©n√©ration build.xml des grammaires sans options pour les aligner avec la g√©n√©ration Eclipse
- ajout√© la grammaire sans package
- ajout√© les annotations optionnelles dans ExpansionUnitTCF
- supprim√© le GTToken et le NodeToken.tokenImage
- revu les .gitignore

Fait sur JTB en 1.5.0
- cr√©√© les pages wiki, mis √† jour les diff√©rents fichiers de docs et autres
- pass√© en JDK 1.8
- ajout√© des annotations pour supprimer des warnings et utilis√© des try-with-resource
- supprim√© la classe JTBToolkit g√©n√©r√©e avec le parseur
- modifi√© AllocationExpression pour prendre en compte EmptyTypeArguments
- remis les serialVersionUID au num√©ro de version JTBToolkit
- renomm√© en Unused les classes (venant du parseur JavaCC) non utilis√©es pour la g√©n√©ration JTB
- ajout√© la g√©n√©ration de la classe NodeConstants.java
- ajout√© l'option et la g√©n√©ration des classe et interface et appels de m√©thodes node scope hook dans les BNFProduction
- ajout√© la g√©n√©ration d'une signature de contr√¥le dans les commentaires des classes et m√©thodes visit, dans NodeConstants,
   et d'une annotation sur les m√©thodes visit des visiteurs par d√©faut, et d'une classe d'annotation et de processeur d'annotation, 
   et d'une option pour supprimer la g√©n√©ration de ces annotations
- pass√© le projet en UTF-8, enrichi le pom.xml
- ajout√© l'option novis (ne pas g√©n√©rer les visiteurs)
- ajout√© la g√©n√©ration des m√©thodes children et de l'option associ√©e
- migr√© les listes de ClassInfo dans FieldInfo, chang√© les for iterator en enhanced for
- supprim√© l'option scheme
- revu certaines javadoc
- supprim√© la classe InternalError et la m√©thode inutilis√©e de FieldNameGenerator qui l'utilisait seule
- ajout√© l'appel √† une m√©thode d'une classe externe pour la g√©n√©ration de classes
- refondu la g√©n√©ration des visiteurs avec tous les types possibles pour les arguments et le retour
- restructur√© / renomm√© les classes et packages
- pass√© en structure maven (generate / tests)
- pass√© en stdout + stderr
- pass√© la g√©n√©ration des user classes en parall√®le
- supprim√© les FileExistsException
- pass√© en non static en gardant do_main static
- pass√© UCDetector et corrig√© ou mis en commentaires les final et modifiers
- ajout√© l'appel √† System.exit(in) dans JTB.main(String[]) (pour ant)
- modifi√© la gestion des special tokens : JTB_TK stocke dans les n≈ìuds JTB les special tokens JavaCC et JTB_TKJJ les imprime 
- ajout√© final dans ExpansionUnitTCF's catch
- ajout√© dans le build.xml une t√¢che d'ajout des SuppressWarnings pour jtbgram.jtb, et chang√© les depend en antcall
- mis l'√©num√©ration des langues et des extensions
- revu la gestion des n≈ìuds ne devant pas √™tre cr√©√©s
- cr√©√© le data model pour FreeMarker
- rajout√© la compilation  et l'ex√©cution de grammaires de test dans build.xml
- ajout√© les @SuppressWarnings lorsque les commentaires javadoc ne sont pas demand√©s et pour les cas unused
- corrig√© une partie des lignes blanches manquantes dans les specials
- ajout√© l'analyse de la couverture de tests et la production des rapports via JaCoCo
- ajout√© les exemples de JJTree et leur √©quivalent JTB
- enrichi les grammaires de tests
- restructur√© / simplifi√© le build.xml
- corrig√© la mauvaise g√©n√©ration du nom des m√©thodes lors d'un pr√©fixe / suffixe (JTB_P) et d'une suppression de la g√©n√©ration des n≈ìuds (!)
- corrig√© la mauvaise g√©n√©ration des types de retour tableaux
- pass√© Expression dans semantic lookahead en optionnel
- pass√© releases.notes, HowTo.txt en md, compl√©t√© README.md
- pass√© le wiki en md
- test√© avec JavaCC 7.0.10
- supprim√© la g√©n√©ration des NodeTCF et des TCF dans les visiteurs
- afficher les paths g√©n√©r√©s en absolu, sans les ../..
- ajout√© un test avec ("xxx"|{}) (issue #86)
- modifi√© les m√©thodes d√©pr√©ci√©es
- g√©n√©r√© correctement les imports si pas d'options
- chang√© le package de jtbgram.jtb (EDU.purdue.jtb.parser) pour l'aligner sur celui d√©clar√© dans la grammaire

Fait sur JTB en 1.4.13
- ajout√© les options dans la grammaire pour une g√©n√©ration correcte directe sous Eclipse
- ajout√© des commentaires dans le fichier Token.java.save
- corrig√© le probl√®me d'espace sur les modifiers de d√©claration de variables locales (Annotator:VariableModifiers)

Fait sur JTB en 1.4.12 (FA)
- modifications fichiers XML et autres pour build et maven
- passage sous Git / GitHub
=======
- jtbgram.jtb a ÈtÈ Ècrite ‡ partir de JavaCC.jj de la version JavaCC 4.2, et adaptÈe (voir commentaires ModMMa) :
  * renommages de noms de classes et de productions
  * ajout de la syntaxe try-ExpansionChoices-catch-finally (ExpansionUnitInTCF) 
  * ajout des syntaxes ! et % pour ne pas gÈnÈrer des noeuds JTB
  * corrections sur la grammaire java
  * ajout des options par dÈfaut
- Token.java a ÈtÈ modifiÈe pour l'ajout de GTToken
- parser.JavaFiles, parser.OtherFilesGen, parser.ParseGen & utils.JavaFileGenerator ont ÈtÈ modifiÈes pour GTToken
   (commentaires : // ModMMa : modified for Token.template with GTToken),
   mais en fait cela ne sert ‡ rien parce c'est JavaCC et non JTB qui gÈnËre Token.java (via parser.OtherFilesGen.java), 
   et bien que le ficher /templates/Token.template n'existe pas cela ne se voit pas car les 4 classes ne sont pas utilisÈes

A faire sur JTB
- voir parser.Token.template dans JavaFiles et autres
- option pour gÈnÈrer le extend dans INode et les serialVersionUID :
  * ajouter l'option dans parser.Options
  * factoriser serialUIDDeclaration() de BasesClasses.java et les Èquivalents (SERIAL_UID) dans ClassInfo, et conditionner
  * conditionner dans genINodeInterface() de BasesClasses.java
  * reporter l'option dans le plugin
- gÈnÈrer les visiteurs DF avec et sans inline dans le mÍme code
- gÈnÈrer des visiteurs avec les arguments supplÈmentaires si la production a des arguments
- gÈnÈrer un visiteur de comptage (ou avec un pre et post hook)
- gÈnÈrer un tableau et des ordinaux pour tous les noms de noeuds (comme dans JJT) : les gÈnÈrer en fin des visiteurs DF
   par DepthFirstVisitorsGenerator ‡ partir de classesList
- gÈnÈrer des listeners
- gÈnÈrer avec des templates
- voir indentation ) en toute fin de lookahead ???
- dans JavaCCPrinter.saveToFile(), tester et crÈer les rÈpertoires intermÈdiaires si l'open se plante en FNFE
- sÈparer les packages nÈcessaires ‡ la grammaire de ceux nÈcessaires pour le gÈnÈrateur (misc / utils / parser / xxx)
- voir les warnings dans parser
- voir les ajouts faits par FA ou ‡ faire pour JavaCC 6+ et C++
- vÈrifier avec et sans les commentaires de debug
- vÈrifier avec les noms longs et les noms courts pour les variables intermÈdiaires (dans AcceptInliner)
- vÈrifier avec et sans inline
>>>>>>> cbea16d4233b3f598105db1c1c42b1f6d25c0508

Fait sur JTB en 1.4.14
- crÈÈ les pages wiki, mis ‡ jour les diffÈrents fichiers de docs et autres
- ajoutÈ des annotations pour supprimer des warnings et utilisÈ des try-with-resource
- supprimÈ la classe JTBToolkit gÈnÈrÈe avec le parseur
- rajoutÈ la nature JavaCC au projet
- modifiÈ AllocationExpression pour prendre en compte EmptyTypeArguments

Fait sur JTB en 1.4.13
- ajoutÈ les options dans la grammaire pour une gÈnÈration correcte directe sous Eclipse
- ajoutÈ des commentaires dans le fichier Token.java.save
- corrigÈ le problËme d'espace sur les modifiers de dÈclaration de variables locales (Annotator:VariableModifiers)

Fait sur JTB en 1.4.12 (FA)
- modifications fichiers xml et autres pour build et maven
- passage sous Git / GitHub

Fait sur JTB en 1.4.11
- mis des espaces entre les '<' et '>' et les noms des tokens pour qu'ils s'affichent correctement dans les javadoc (< AMONG > au lieu de <AMONG>)
- corrig√© les conditions d'apparition du "warning:  Empty choice : a NodeChoice with a 'null' choice member ..."
- corrig√© les num√©ros de colonne dans les messages

Fait sur JTB en 1.4.10
- ajout√© la m√©thode JTB.do_main() et modifi√© les m√©thodes Messages.hardErr() pour ne plus appeler System.exit()

Fait sur JTB en 1.4.9
- rien

Fait sur JTB en 1.4.8.fix_a
- corrig√© r√©gression (Annotator#bnfFinalActions())

Fait sur JTB en 1.4.8
- null choice for an empty choice
- contr√¥ler qu'un Javacode n'est pas d√©clar√© 2 fois
- voir bug 3164860
- syntaxe "%" sur Javacode
- corriger pr√©fixe / suffixe dans lookahead
- chang√© dans NodeToken.java  public ArrayList<NodeToken> specialTokens; ->   public List<NodeToken> specialTokens;
- ajout√© AnnotationTypeDeclaration() dans ClassOrInterfaceBodyDeclaration()
- ajout√© ReferenceType() dans ExplicitConstructorInvocation()
- ajout√© des annotations @Override et @SuppressWarnings("unused") dans la g√©n√©ration des visiteurs
- ajout√© node_descriptor() et node_descriptor_expression() et modifi√© JavaCodeProduction, BNFProduction,
   Expansion & MethodDeclaration pour autoriser un node descriptor
- corrig√© la non mise en commentaires des specials dans les options JTB √† la g√©n√©ration
- ajout√© la g√©n√©ration de noms courts pour les variables interm√©diaires
- modifi√© le message de warning sur les LOOKAHEAD ignor√©s (car ils peuvent ne pas √™tre ignor√©s en fait)
- corrig√© la g√©n√©ration des blocs java (Annotator visit LocalVariableDeclaration)
- corrig√© le LOOKAHEAD dans ExplicitConstructorInvocation
- ajout√© la g√©n√©ration des annotations override
- am√©lior√© la gestion des specials
- pass√© les versions de 4.2.j.m √† 5.0
- pass√© de implements constantes √† import static
- renomm√© TreeWalkerOp en ITreeWalkerOp
- enlev√© le membre ordinal de RegularExpression_ qui cachait celui de la superclass Expansion_
- supprim√© les warnings partout sauf dans certaines grosses classes de parser

